#!/bin/bash

# ËÑöÊú¨ÔºöÊõ¥Êñ∞ÁâàÊú¨Âè∑Âπ∂Â∞Ü main ÂàÜÊîØÂêåÊ≠•Âà∞ release ÂàÜÊîØ
# Áî®ÈÄîÔºöÂºÄÂèëÂú® main ‰∏äÂÆåÊàêÂêéÔºå‰ΩøÁî®Ê≠§ËÑöÊú¨Êõ¥Êñ∞ÁâàÊú¨Âè∑„ÄÅÊèê‰∫§„ÄÅÊâìÊ†áÁ≠æÔºåÁÑ∂ÂêéÂêåÊ≠•Âà∞ release ÂàÜÊîØËß¶ÂèëÊûÑÂª∫

set -e  # ÈÅáÂà∞ÈîôËØØÁ´ãÂç≥ÈÄÄÂá∫

# È¢úËâ≤ÂÆö‰πâ
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m' # No Color

echo ""
echo "================================================"
echo "  üì¶ ÁâàÊú¨ÂèëÂ∏ÉÂ∑•ÂÖ∑ (ÁâàÊú¨Êõ¥Êñ∞ + ÂêåÊ≠•Âà∞ Release)"
echo "================================================"
echo ""

# ÈÖçÁΩÆÊñá‰ª∂Ë∑ØÂæÑ
TAURI_CONF="src-tauri/tauri.conf.json"
PACKAGE_JSON="package.json"

# ============================================
# Ê≠•È™§ 1: Ê£ÄÊü•ÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩïÁä∂ÊÄÅ
# ============================================
echo -e "${YELLOW}[1/10] Ê£ÄÊü•Â∑•‰ΩúÁõÆÂΩïÁä∂ÊÄÅ...${NC}"
if [[ -n $(git status -s) ]]; then
    echo -e "${RED}‚ùå ÈîôËØØ: Â∑•‰ΩúÁõÆÂΩïÊúâÊú™Êèê‰∫§ÁöÑÊîπÂä®ÔºåËØ∑ÂÖàÊèê‰∫§ÊàñÊöÇÂ≠ò„ÄÇ${NC}"
    git status -s
    echo ""
    exit 1
fi
echo -e "${GREEN}‚úì Â∑•‰ΩúÁõÆÂΩïÂπ≤ÂáÄ${NC}"
echo ""

# ============================================
# Ê≠•È™§ 2: Ëé∑ÂèñÂΩìÂâçÂàÜÊîØÂπ∂Ê£ÄÊü•
# ============================================
CURRENT_BRANCH=$(git branch --show-current)
echo -e "${YELLOW}[2/10] ÂΩìÂâçÂàÜÊîØ: ${CURRENT_BRANCH}${NC}"

# Â¶ÇÊûú‰∏çÂú® main ÂàÜÊîØÔºåÂÖàÂàáÊç¢Âà∞ main
if [[ "$CURRENT_BRANCH" != "main" ]]; then
    echo -e "${BLUE}ÂàáÊç¢Âà∞ main ÂàÜÊîØ...${NC}"
    git checkout main
    git pull origin main
fi
echo ""

# ============================================
# Ê≠•È™§ 3: ËØªÂèñÂΩìÂâçÁâàÊú¨Âè∑
# ============================================
echo -e "${YELLOW}[3/10] ËØªÂèñÂΩìÂâçÁâàÊú¨Âè∑...${NC}"

CURRENT_VERSION=""
if [ -f "$TAURI_CONF" ]; then
    if command -v jq &> /dev/null; then
        CURRENT_VERSION=$(jq -r '.version' "$TAURI_CONF" 2>/dev/null)
    else
        CURRENT_VERSION=$(grep -o '"version"[[:space:]]*:[[:space:]]*"[^"]*"' "$TAURI_CONF" | head -1 | sed 's/.*"\([^"]*\)".*/\1/')
    fi
fi

if [ -z "$CURRENT_VERSION" ] || [ "$CURRENT_VERSION" = "null" ]; then
    if [ -f "$PACKAGE_JSON" ]; then
        if command -v jq &> /dev/null; then
            CURRENT_VERSION=$(jq -r '.version' "$PACKAGE_JSON" 2>/dev/null)
        else
            CURRENT_VERSION=$(grep -o '"version"[[:space:]]*:[[:space:]]*"[^"]*"' "$PACKAGE_JSON" | head -1 | sed 's/.*"\([^"]*\)".*/\1/')
        fi
    fi
fi

if [ -z "$CURRENT_VERSION" ] || [ "$CURRENT_VERSION" = "null" ]; then
    echo -e "${RED}‚ùå ÈîôËØØ: Êó†Ê≥ïËØªÂèñÂΩìÂâçÁâàÊú¨Âè∑${NC}"
    echo ""
    exit 1
fi

echo -e "${CYAN}üìã ÂΩìÂâçÁâàÊú¨: $CURRENT_VERSION${NC}"
echo ""

# ============================================
# Ê≠•È™§ 4: ËÆ°ÁÆóÂπ∂ÈÄâÊã©Êñ∞ÁâàÊú¨Âè∑
# ============================================
echo -e "${YELLOW}[4/10] ÈÄâÊã©Êñ∞ÁâàÊú¨Âè∑...${NC}"

# ËÆ°ÁÆóÂª∫ËÆÆÁöÑÁâàÊú¨Âè∑
suggest_versions() {
    local current=$1
    if [[ $current =~ ^([0-9]+)\.([0-9]+)\.([0-9]+)$ ]]; then
        local major="${BASH_REMATCH[1]}"
        local minor="${BASH_REMATCH[2]}"
        local patch="${BASH_REMATCH[3]}"
        
        SUGGESTED_PATCH="$major.$minor.$((patch + 1))"
        SUGGESTED_MINOR="$major.$((minor + 1)).0"
        SUGGESTED_MAJOR="$((major + 1)).0.0"
    else
        echo -e "${RED}‚ùå ÈîôËØØ: ÁâàÊú¨Âè∑Ê†ºÂºè‰∏çÊ≠£Á°Æ (Â∫î‰∏∫ x.y.z)${NC}"
        exit 1
    fi
}

suggest_versions "$CURRENT_VERSION"

NEW_VERSION=""

if [ -n "$1" ]; then
    # Â¶ÇÊûúÊèê‰æõ‰∫ÜÂëΩ‰ª§Ë°åÂèÇÊï∞ÔºåÁõ¥Êé•‰ΩøÁî®
    NEW_VERSION=$1
    echo -e "${GREEN}‚úì ‰ΩøÁî®ÂëΩ‰ª§Ë°åÂèÇÊï∞ÊåáÂÆöÁöÑÁâàÊú¨: $NEW_VERSION${NC}"
else
    # ‰∫§‰∫íÂºèÈÄâÊã©
    echo ""
    echo -e "${CYAN}üí° ÁâàÊú¨ÂçáÁ∫ßÈÄâÈ°π:${NC}"
    echo ""
    echo "   [1] üêõ Ë°•‰∏ÅÁâàÊú¨ (Patch): $SUGGESTED_PATCH"
    echo "       ‚îî‚îÄ Áî®‰∫é: Bug ‰øÆÂ§ç„ÄÅÂ∞èÊîπËøõ"
    echo ""
    echo "   [2] ‚ú® Ê¨°ÁâàÊú¨ (Minor):  $SUGGESTED_MINOR"
    echo "       ‚îî‚îÄ Áî®‰∫é: Êñ∞ÂäüËÉΩ„ÄÅÂêëÂêéÂÖºÂÆπÁöÑÊõ¥Êîπ"
    echo ""
    echo "   [3] üöÄ ‰∏ªÁâàÊú¨ (Major):  $SUGGESTED_MAJOR"
    echo "       ‚îî‚îÄ Áî®‰∫é: ÈáçÂ§ßÊõ¥Êñ∞„ÄÅÁ†¥ÂùèÊÄßÊõ¥Êîπ"
    echo ""
    echo "   [0] ‚úèÔ∏è  Ëá™ÂÆö‰πâÁâàÊú¨"
    echo ""
    
    read -p "üì¶ ËØ∑ÈÄâÊã©ÁâàÊú¨Á±ªÂûã (1/2/3/0) [ÈªòËÆ§: 1]: " VERSION_CHOICE
    VERSION_CHOICE=${VERSION_CHOICE:-1}
    
    case "$VERSION_CHOICE" in
        "1")
            NEW_VERSION=$SUGGESTED_PATCH
            echo -e "${GREEN}‚úì ÈÄâÊã©Ë°•‰∏ÅÁâàÊú¨: $NEW_VERSION${NC}"
            ;;
        "2")
            NEW_VERSION=$SUGGESTED_MINOR
            echo -e "${GREEN}‚úì ÈÄâÊã©Ê¨°ÁâàÊú¨: $NEW_VERSION${NC}"
            ;;
        "3")
            NEW_VERSION=$SUGGESTED_MAJOR
            echo -e "${GREEN}‚úì ÈÄâÊã©‰∏ªÁâàÊú¨: $NEW_VERSION${NC}"
            ;;
        "0")
            echo ""
            read -p "   ‚úèÔ∏è  ËØ∑ËæìÂÖ•Ëá™ÂÆö‰πâÁâàÊú¨Âè∑: " NEW_VERSION
            if [ -z "$NEW_VERSION" ]; then
                echo -e "${RED}‚ùå ÈîôËØØ: ÁâàÊú¨Âè∑‰∏çËÉΩ‰∏∫Á©∫${NC}"
                exit 1
            fi
            ;;
        *)
            if [[ "$VERSION_CHOICE" =~ ^[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
                NEW_VERSION=$VERSION_CHOICE
                echo -e "${GREEN}‚úì ‰ΩøÁî®ËæìÂÖ•ÁöÑÁâàÊú¨: $NEW_VERSION${NC}"
            else
                echo -e "${RED}‚ùå ÈîôËØØ: Êó†ÊïàÁöÑÈÄâÊã©ÊàñÁâàÊú¨Âè∑Ê†ºÂºè${NC}"
                exit 1
            fi
            ;;
    esac
fi

echo ""

# È™åËØÅÁâàÊú¨Âè∑Ê†ºÂºè
if [[ ! "$NEW_VERSION" =~ ^[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
    echo -e "${RED}‚ùå ÈîôËØØ: ÁâàÊú¨Âè∑Ê†ºÂºè‰∏çÊ≠£Á°Æ (Â∫î‰∏∫ x.y.z)${NC}"
    echo ""
    exit 1
fi

# Ê£ÄÊü•ÁâàÊú¨Âè∑ÊòØÂê¶ÊúâÂèòÂåñ
if [ "$NEW_VERSION" = "$CURRENT_VERSION" ]; then
    echo -e "${YELLOW}‚ö†Ô∏è  Ë≠¶Âëä: Êñ∞ÁâàÊú¨Âè∑‰∏éÂΩìÂâçÁâàÊú¨Áõ∏Âêå${NC}"
    echo ""
    read -p "ÊòØÂê¶ÁªßÁª≠Ôºü(y/N): " CONTINUE_SAME
    if [[ ! "$CONTINUE_SAME" =~ ^[Yy]$ ]]; then
        echo -e "${BLUE}Â∑≤ÂèñÊ∂àÂèëÂ∏É${NC}"
        exit 0
    fi
    echo ""
fi

# ÊúÄÂêéÁ°ÆËÆ§
echo "================================================"
echo -e "${CYAN}üìù ÂèëÂ∏ÉÈ¢ÑËßà${NC}"
echo "================================================"
echo ""
echo -e "   ${YELLOW}ÊóßÁâàÊú¨:${NC} $CURRENT_VERSION"
echo -e "   ${GREEN}Êñ∞ÁâàÊú¨:${NC} $NEW_VERSION"
echo ""
echo "   Â∞ÜÊâßË°å‰ª•‰∏ãÊìç‰Ωú:"
echo "   1. Êõ¥Êñ∞ÁâàÊú¨Âè∑Êñá‰ª∂"
echo "   2. Êèê‰∫§ÁâàÊú¨Êõ¥Êñ∞"
echo "   3. ÂàõÂª∫ Git Ê†áÁ≠æ v$NEW_VERSION"
echo "   4. Êé®ÈÄÅÂà∞ main ÂàÜÊîØ"
echo "   5. ÂêåÊ≠•Âà∞ release ÂàÜÊîØËß¶ÂèëÊûÑÂª∫"
echo ""

read -p "Á°ÆËÆ§ÂèëÂ∏ÉÊñ∞ÁâàÊú¨Ôºü(Y/n): " CONFIRM
CONFIRM=${CONFIRM:-Y}
if [[ ! "$CONFIRM" =~ ^[Yy]$ ]]; then
    echo -e "${BLUE}Â∑≤ÂèñÊ∂àÂèëÂ∏É${NC}"
    exit 0
fi

echo ""

# ============================================
# Ê≠•È™§ 5: Êõ¥Êñ∞ÁâàÊú¨Âè∑Êñá‰ª∂
# ============================================
echo "================================================"
echo -e "${CYAN}üîÑ Ê≠£Âú®Êõ¥Êñ∞ÁâàÊú¨Âè∑...${NC}"
echo "================================================"
echo ""

UPDATE_SUCCESS=0
UPDATE_FAILED=0

# Êõ¥Êñ∞ tauri.conf.json
if [ -f "$TAURI_CONF" ]; then
    echo -e "${BLUE}[5/10] Êõ¥Êñ∞ $TAURI_CONF...${NC}"
    cp "$TAURI_CONF" "${TAURI_CONF}.backup"
    
    if command -v jq &> /dev/null; then
        TMP_FILE=$(mktemp)
        if jq --arg version "$NEW_VERSION" '.version = $version' "$TAURI_CONF" > "$TMP_FILE"; then
            mv "$TMP_FILE" "$TAURI_CONF"
            echo -e "${GREEN}   ‚úÖ Â∑≤Êõ¥Êñ∞ tauri.conf.json${NC}"
            UPDATE_SUCCESS=$((UPDATE_SUCCESS + 1))
        else
            echo -e "${RED}   ‚ùå Êõ¥Êñ∞Â§±Ë¥•${NC}"
            mv "${TAURI_CONF}.backup" "$TAURI_CONF"
            UPDATE_FAILED=$((UPDATE_FAILED + 1))
        fi
    else
        if [[ "$OSTYPE" == "darwin"* ]]; then
            if sed -i '' "s/\"version\"[[:space:]]*:[[:space:]]*\"[^\"]*\"/\"version\": \"$NEW_VERSION\"/" "$TAURI_CONF"; then
                echo -e "${GREEN}   ‚úÖ Â∑≤Êõ¥Êñ∞ tauri.conf.json${NC}"
                UPDATE_SUCCESS=$((UPDATE_SUCCESS + 1))
            else
                echo -e "${RED}   ‚ùå Êõ¥Êñ∞Â§±Ë¥•${NC}"
                mv "${TAURI_CONF}.backup" "$TAURI_CONF"
                UPDATE_FAILED=$((UPDATE_FAILED + 1))
            fi
        else
            if sed -i "s/\"version\"[[:space:]]*:[[:space:]]*\"[^\"]*\"/\"version\": \"$NEW_VERSION\"/" "$TAURI_CONF"; then
                echo -e "${GREEN}   ‚úÖ Â∑≤Êõ¥Êñ∞ tauri.conf.json${NC}"
                UPDATE_SUCCESS=$((UPDATE_SUCCESS + 1))
            else
                echo -e "${RED}   ‚ùå Êõ¥Êñ∞Â§±Ë¥•${NC}"
                mv "${TAURI_CONF}.backup" "$TAURI_CONF"
                UPDATE_FAILED=$((UPDATE_FAILED + 1))
            fi
        fi
    fi
    
    # È™åËØÅÊõ¥Êñ∞
    if command -v jq &> /dev/null; then
        VERIFY_VERSION=$(jq -r '.version' "$TAURI_CONF" 2>/dev/null)
    else
        VERIFY_VERSION=$(grep -o '"version"[[:space:]]*:[[:space:]]*"[^"]*"' "$TAURI_CONF" | head -1 | sed 's/.*"\([^"]*\)".*/\1/')
    fi
    
    if [ "$VERIFY_VERSION" = "$NEW_VERSION" ]; then
        echo -e "${GREEN}   ‚úì È™åËØÅÈÄöËøá: $VERIFY_VERSION${NC}"
        rm -f "${TAURI_CONF}.backup"
    else
        echo -e "${RED}   ‚úó È™åËØÅÂ§±Ë¥•${NC}"
        mv "${TAURI_CONF}.backup" "$TAURI_CONF"
        UPDATE_FAILED=$((UPDATE_FAILED + 1))
        UPDATE_SUCCESS=$((UPDATE_SUCCESS - 1))
    fi
    echo ""
fi

# Êõ¥Êñ∞ package.json
if [ -f "$PACKAGE_JSON" ]; then
    echo -e "${BLUE}[6/10] Êõ¥Êñ∞ $PACKAGE_JSON...${NC}"
    cp "$PACKAGE_JSON" "${PACKAGE_JSON}.backup"
    
    if command -v jq &> /dev/null; then
        TMP_FILE=$(mktemp)
        if jq --arg version "$NEW_VERSION" '.version = $version' "$PACKAGE_JSON" > "$TMP_FILE"; then
            mv "$TMP_FILE" "$PACKAGE_JSON"
            echo -e "${GREEN}   ‚úÖ Â∑≤Êõ¥Êñ∞ package.json${NC}"
            UPDATE_SUCCESS=$((UPDATE_SUCCESS + 1))
        else
            echo -e "${RED}   ‚ùå Êõ¥Êñ∞Â§±Ë¥•${NC}"
            mv "${PACKAGE_JSON}.backup" "$PACKAGE_JSON"
            UPDATE_FAILED=$((UPDATE_FAILED + 1))
        fi
    else
        if [[ "$OSTYPE" == "darwin"* ]]; then
            if sed -i '' "s/\"version\"[[:space:]]*:[[:space:]]*\"[^\"]*\"/\"version\": \"$NEW_VERSION\"/" "$PACKAGE_JSON"; then
                echo -e "${GREEN}   ‚úÖ Â∑≤Êõ¥Êñ∞ package.json${NC}"
                UPDATE_SUCCESS=$((UPDATE_SUCCESS + 1))
            else
                echo -e "${RED}   ‚ùå Êõ¥Êñ∞Â§±Ë¥•${NC}"
                mv "${PACKAGE_JSON}.backup" "$PACKAGE_JSON"
                UPDATE_FAILED=$((UPDATE_FAILED + 1))
            fi
        else
            if sed -i "s/\"version\"[[:space:]]*:[[:space:]]*\"[^\"]*\"/\"version\": \"$NEW_VERSION\"/" "$PACKAGE_JSON"; then
                echo -e "${GREEN}   ‚úÖ Â∑≤Êõ¥Êñ∞ package.json${NC}"
                UPDATE_SUCCESS=$((UPDATE_SUCCESS + 1))
            else
                echo -e "${RED}   ‚ùå Êõ¥Êñ∞Â§±Ë¥•${NC}"
                mv "${PACKAGE_JSON}.backup" "$PACKAGE_JSON"
                UPDATE_FAILED=$((UPDATE_FAILED + 1))
            fi
        fi
    fi
    
    # È™åËØÅÊõ¥Êñ∞
    if command -v jq &> /dev/null; then
        VERIFY_VERSION=$(jq -r '.version' "$PACKAGE_JSON" 2>/dev/null)
    else
        VERIFY_VERSION=$(grep -o '"version"[[:space:]]*:[[:space:]]*"[^"]*"' "$PACKAGE_JSON" | head -1 | sed 's/.*"\([^"]*\)".*/\1/')
    fi
    
    if [ "$VERIFY_VERSION" = "$NEW_VERSION" ]; then
        echo -e "${GREEN}   ‚úì È™åËØÅÈÄöËøá: $VERIFY_VERSION${NC}"
        rm -f "${PACKAGE_JSON}.backup"
    else
        echo -e "${RED}   ‚úó È™åËØÅÂ§±Ë¥•${NC}"
        mv "${PACKAGE_JSON}.backup" "$PACKAGE_JSON"
        UPDATE_FAILED=$((UPDATE_FAILED + 1))
        UPDATE_SUCCESS=$((UPDATE_SUCCESS - 1))
    fi
    echo ""
fi

# Ê£ÄÊü•Êõ¥Êñ∞ÁªìÊûú
if [ $UPDATE_FAILED -gt 0 ]; then
    echo -e "${RED}‚ùå ÁâàÊú¨Âè∑Êõ¥Êñ∞Â§±Ë¥•ÔºåÂ∑≤ÊÅ¢Â§çÂ§á‰ªΩÊñá‰ª∂${NC}"
    echo ""
    exit 1
fi

echo -e "${GREEN}‚úÖ ÁâàÊú¨Âè∑Êõ¥Êñ∞ÊàêÂäü${NC}"
echo ""

# ============================================
# Ê≠•È™§ 6: Êèê‰∫§ÁâàÊú¨Êõ¥Êñ∞
# ============================================
echo -e "${YELLOW}[7/10] Êèê‰∫§ÁâàÊú¨Êõ¥Êñ∞...${NC}"
git add "$TAURI_CONF" "$PACKAGE_JSON"
git commit -m "chore: bump version to $NEW_VERSION"
echo -e "${GREEN}‚úì ÁâàÊú¨Êõ¥Êñ∞Â∑≤Êèê‰∫§${NC}"
echo ""

# ============================================
# Ê≠•È™§ 7: ÂàõÂª∫ Git Ê†áÁ≠æ
# ============================================
echo -e "${YELLOW}[8/10] ÂàõÂª∫ Git Ê†áÁ≠æ v$NEW_VERSION...${NC}"
if git tag -a "v$NEW_VERSION" -m "Release v$NEW_VERSION"; then
    echo -e "${GREEN}‚úì Ê†áÁ≠æÂ∑≤ÂàõÂª∫${NC}"
else
    echo -e "${YELLOW}‚ö†Ô∏è  Ê†áÁ≠æÂèØËÉΩÂ∑≤Â≠òÂú®ÔºåÁªßÁª≠...${NC}"
fi
echo ""

# ============================================
# Ê≠•È™§ 8: Êé®ÈÄÅÂà∞ main ÂàÜÊîØ
# ============================================
echo -e "${YELLOW}[9/10] Êé®ÈÄÅÂà∞ main ÂàÜÊîØ...${NC}"
git push origin main
git push origin "v$NEW_VERSION"
echo -e "${GREEN}‚úì Â∑≤Êé®ÈÄÅÂà∞ main ÂàÜÊîØ${NC}"
echo ""

# ============================================
# Ê≠•È™§ 9: ÂêåÊ≠•Âà∞ release ÂàÜÊîØ
# ============================================
echo -e "${YELLOW}[10/10] ÂêåÊ≠•Âà∞ release ÂàÜÊîØ...${NC}"
echo ""

# ÊãâÂèñÊúÄÊñ∞ÁöÑËøúÁ®ãÂàÜÊîØ
echo -e "${BLUE}   ‚Üí ÊãâÂèñËøúÁ®ãÊúÄÊñ∞‰ª£Á†Å...${NC}"
git fetch origin
echo ""

# ÂàáÊç¢Âà∞ release ÂàÜÊîØ
echo -e "${BLUE}   ‚Üí ÂàáÊç¢Âà∞ release ÂàÜÊîØ...${NC}"
git checkout release
git pull origin release
echo ""

# ÂêàÂπ∂ main Âà∞ release
echo -e "${BLUE}   ‚Üí ÂêàÂπ∂ main Âà∞ release...${NC}"
if git merge main --no-edit; then
    echo -e "${GREEN}   ‚úì ÂêàÂπ∂ÊàêÂäü${NC}"
else
    echo -e "${RED}   ‚ùå ÈîôËØØ: ÂêàÂπ∂ÂÜ≤Á™ÅÔºåËØ∑ÊâãÂä®Ëß£ÂÜ≥ÂÜ≤Á™Å${NC}"
    echo ""
    echo "   ËØ∑ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ëß£ÂÜ≥ÂÜ≤Á™ÅÔºö"
    echo "   1. git add ."
    echo "   2. git commit"
    echo "   3. git push origin release"
    echo ""
    exit 1
fi
echo ""

# Êé®ÈÄÅÂà∞ËøúÁ®ã release ÂàÜÊîØ
echo -e "${BLUE}   ‚Üí Êé®ÈÄÅÂà∞ËøúÁ®ã release ÂàÜÊîØ...${NC}"
git push origin release
echo -e "${GREEN}   ‚úì Êé®ÈÄÅÊàêÂäü${NC}"
echo ""

# ============================================
# Ê≠•È™§ 10: ÂàáÊç¢ÂõûÂéüÂàÜÊîØ
# ============================================
if [[ "$CURRENT_BRANCH" != "main" && "$CURRENT_BRANCH" != "release" ]]; then
    echo -e "${BLUE}ÂàáÊç¢ÂõûÂéüÂàÜÊîØ: ${CURRENT_BRANCH}${NC}"
    git checkout "$CURRENT_BRANCH"
    echo ""
else
    git checkout main
fi

# ============================================
# ÊòæÁ§∫ÂÆåÊàê‰ø°ÊÅØ
# ============================================
echo "================================================"
echo -e "${GREEN}üéâ ÁâàÊú¨ÂèëÂ∏ÉÂÆåÊàêÔºÅ${NC}"
echo "================================================"
echo ""
echo -e "${CYAN}üìä ÂèëÂ∏ÉÊëòË¶Å:${NC}"
echo ""
echo "   ‚Ä¢ ÁâàÊú¨Âè∑: $CURRENT_VERSION ‚Üí $NEW_VERSION"
echo "   ‚Ä¢ Git Ê†áÁ≠æ: v$NEW_VERSION"
echo "   ‚Ä¢ Â∑≤Êé®ÈÄÅÂà∞ main ÂàÜÊîØ"
echo "   ‚Ä¢ Â∑≤ÂêåÊ≠•Âà∞ release ÂàÜÊîØ"
echo ""
echo -e "${GREEN}‚úì GitHub Actions Â∞ÜËá™Âä®ÂºÄÂßãÊûÑÂª∫...${NC}"
echo ""
echo -e "${YELLOW}üîó Êü•ÁúãÊûÑÂª∫Áä∂ÊÄÅ:${NC}"
echo "   https://github.com/$(git remote get-url origin | sed 's/.*github.com[:\/]\(.*\)\.git/\1/')/actions"
echo ""

